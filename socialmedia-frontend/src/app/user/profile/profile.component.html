<div class="profile-container h-screen flex justify-center">
    <div *ngIf="!isEditMode" class="w-full max-w-6xl">
      <div class="profile-header items-center">
        <div class="profile-picture-container">
          <img [src]="user?.profileImageUrl || 'assets/avatar.png'" alt="Profile picture" class="profile-picture">
        </div>
  
        <div class="profile-info">
          <div class="username-actions">
            <h1 class="username">{{ user?.userName || 'username' }}</h1>
            <div class="action-buttons">
              <p-button styleClass="p-button-outlined" *ngIf="isOwnProfile" (click)="isEditMode = true">Edit Profile</p-button>
              <p-button *ngIf="!isOwnProfile && !isFollowing" (click)="onFollow()">Follow</p-button>
              <p-button *ngIf="!isOwnProfile && isFollowing" (click)="onUnfollow()">Unfollow</p-button>
              <p-menu #menu [popup]="true" [model]="menuItems"></p-menu>
              <p-button icon="pi pi-ellipsis-h" styleClass="p-button-text p-button-rounded" (onClick)="menu.toggle($event)"></p-button>
            </div>
          </div>
  
          <div class="profile-stats">
            <span><strong>{{ postCount || 0 }}</strong> posts</span>
            <span><strong>{{ followerCount || 0 }}</strong> followers</span>
            <span><strong>{{ followingCount || 0 }}</strong> following</span>
          </div>
  
          <div class="full-name-bio">
            <h2 class="full-name">{{ user?.firstName }} {{ user?.lastName }}</h2>
            <p class="bio">{{ user?.biography || 'No biography provided' }}</p>
          </div>
        </div>
      </div>
  
      <div class="content-border"></div>
  
      <div class="posts-grid" *ngIf="posts?.length; else noPosts">
        <div class="post-item" *ngFor="let post of posts">
          <img [src]="post.imageUrl" alt="Post">
          <div class="post-overlay">
            <div class="post-stats">
              <span><mat-icon>favorite</mat-icon> {{ post.likeCount }}</span>
              <span><mat-icon>comment</mat-icon> {{ post.commentCount }}</span>
            </div>
          </div>
        </div>
      </div>
  
      <ng-template #noPosts>
        <div *ngIf="isOwnProfile" class="no-posts">
          <!-- TODO: Change color to variables -->
          <i class="pi pi-camera" style="font-size: 50px; color: var(--text-color-secondary);"></i>
          <h2>No Posts Yet</h2>
          <p>When you share photos, they will appear on your profile</p>
          <p-button (click)="goToUploadPage()">Share your first photo</p-button>
        </div>
      </ng-template>
    </div>
  
    <app-profile-edit
      *ngIf="isEditMode"
      [user]="user"
      (saveChanges)="onSaveChanges($event)"
      (cancelEdit)="isEditMode = false"
    ></app-profile-edit>
</div>
